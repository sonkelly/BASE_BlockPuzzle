{"version":3,"sources":["assets/Scripts/PUC.ts"],"names":[],"mappings":";;;;;;;;;;;;AAAQ,IAAA,OAAO,GAAK,EAAE,CAAC,UAAU,QAAlB,CAAmB;AAGlC;IAAA;QACY,QAAG,GAAQ,IAAI,CAAC;QAChB,aAAQ,GAAQ,IAAI,CAAC;QACrB,oBAAe,GAAQ,IAAI,CAAC;QAC5B,6BAAwB,GAAW,CAAC,CAAC;QACrC,2BAAsB,GAAY,KAAK,CAAC;QACxC,0BAAqB,GAAY,KAAK,CAAC;QACvC,yBAAoB,GAAW,KAAK,CAAC;IAmNjD,CAAC;IAjNU,kBAAI,GAAX;QACI,IAAI,CAAC,GAAG,GAAG,EAAE,CAAC;IAClB,CAAC;IAEM,oBAAM,GAAb,cAAuB,CAAC;IAEjB,wBAAU,GAAjB,UAAkB,IAAqB;QAArB,qBAAA,EAAA,YAAqB;QACnC,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAChB,IAAM,MAAM,GAAG;gBACX,KAAK,EAAE;oBACH,KAAK,EAAE,SAAS,CAAC,MAAM,CAAC,WAAW;oBACnC,MAAM,EAAE,SAAS,CAAC,MAAM,CAAC,YAAY;oBACrC,OAAO,EAAE,CAAC;iBACb;aACJ,CAAC;YAEF,IAAI,CAAC,QAAQ,GAAG,EAAE,CAAC,cAAc,CAAC,MAAM,CAAC,CAAC;YAC1C,IAAI,CAAC,QAAQ,CAAC,MAAM,CAAC,cAAO,CAAC,CAAC,CAAC;YAC/B,IAAI,CAAC,QAAQ,CAAC,OAAO,CAAC,cAAO,CAAC,CAAC,CAAC;YAEhC,IAAI,IAAI,EAAE;gBACN,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;aACxB;SACJ;IACL,CAAC;IAEM,wBAAU,GAAjB;QACI,IAAI,CAAC,UAAU,EAAE,CAAC;QAClB,IAAI,IAAI,CAAC,QAAQ,EAAE;YACf,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;SACxB;aAAM;YACH,IAAI,CAAC,UAAU,CAAC,IAAI,CAAC,CAAC;SACzB;IACL,CAAC;IAEM,wBAAU,GAAjB;QACI,IAAI,IAAI,CAAC,QAAQ,EAAE;YACf,IAAI,CAAC,QAAQ,CAAC,OAAO,EAAE,CAAC;YACxB,IAAI,CAAC,QAAQ,GAAG,IAAI,CAAC;SACxB;IACL,CAAC;IAEM,8BAAgB,GAAvB,cAAiC,CAAC;IAE3B,iCAAmB,GAA1B,UAA2B,QAAyB;QAAzB,yBAAA,EAAA,gBAAyB;QAChD,IAAI,SAAS,CAAC,MAAM,CAAC,eAAe,EAAE;YAClC,IAAI,CAAC,IAAI,CAAC,eAAe,IAAI,OAAO,IAAI,CAAC,GAAG,CAAC,qBAAqB,KAAK,UAAU,EAAE;gBAC/E,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC,GAAG,CAAC,qBAAqB,CAAC;oBAClD,QAAQ,EAAE,SAAS,CAAC,MAAM,CAAC,eAAe;iBAC7C,CAAC,CAAC;gBAEH,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;gBACnE,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,IAAI,CAAC,oBAAoB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;gBACnE,IAAI,CAAC,eAAe,CAAC,MAAM,CAAC,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC,CAAC;aACpE;YAED,IAAI,QAAQ,EAAE;gBACV,IAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;aACtC;SACJ;IACL,CAAC;IAEM,+BAAiB,GAAxB,UAAyB,QAAyB;QAAzB,yBAAA,EAAA,gBAAyB;QAC9C,IAAI,CAAC,mBAAmB,CAAC,QAAQ,CAAC,CAAC;QACnC,SAAS,CAAC,IAAI,CAAC,+CAA+C,CAAC,CAAC;IACpE,CAAC;IAEO,iCAAmB,GAA3B;QACI,SAAS,CAAC,IAAI,CAAC,kDAAkD,GAAG,IAAI,CAAC,sBAAsB,CAAC,CAAC;IACrG,CAAC;IAEO,kCAAoB,GAA5B,UAA6B,KAAU,EAAE,OAAe;QACpD,SAAS,CAAC,IAAI,CAAC,4BAA4B,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,GAAG,OAAO,GAAG,OAAO,CAAC,CAAC;QACzF,IAAI,CAAC,kBAAkB,EAAE,CAAC;IAC9B,CAAC;IAEO,kCAAoB,GAA5B,UAA6B,MAAW;QACpC,SAAS,CAAC,IAAI,CAAC,mCAAmC,GAAG,MAAM,CAAC,OAAO,CAAC,CAAC;QAErE,IAAI,MAAM,CAAC,OAAO,EAAE;YAChB,SAAS,CAAC,IAAI,CAAC,kCAAkC,GAAG,MAAM,CAAC,GAAG,CAAC,CAAC;YAChE,IAAI,MAAM,CAAC,GAAG,EAAE;gBACZ,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;aAC9B;YACD,IAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;YACrC,IAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;SACjC;aAAM,IAAI,SAAS,CAAC,OAAO,CAAC,kBAAkB,EAAE;YAC7C,IAAM,MAAI,GAAG,IAAI,CAAC;YAClB,MAAI,CAAC,GAAG,CAAC,SAAS,CAAC;gBACf,KAAK,EAAE,KAAK;gBACZ,OAAO,EAAE,cAAc;gBACvB,OAAO,EAAE,UAAS,QAAa;oBAC3B,IAAI,QAAQ,CAAC,OAAO,EAAE;wBAClB,MAAI,CAAC,iBAAiB,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC;qBACtC;yBAAM,IAAI,QAAQ,CAAC,MAAM,EAAE;wBACxB,IAAI,MAAM,CAAC,GAAG,EAAE;4BACZ,MAAM,CAAC,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC,CAAC;yBAC9B;wBACD,MAAI,CAAC,kBAAkB,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;wBACrC,MAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;qBACjC;gBACL,CAAC;aACJ,CAAC,CAAC;SACN;IACL,CAAC;IAEM,+BAAiB,GAAxB,UAAyB,QAAkB;QAA3C,iBAuCC;QAtCG,SAAS,CAAC,IAAI,CAAC,wBAAwB,GAAG,QAAQ,CAAC,CAAC;QAEpD,IAAI,QAAQ,EAAE;YACV,MAAM,CAAC,GAAG,GAAG,QAAQ,CAAC;SACzB;QAED,IAAI,IAAI,CAAC,eAAe,EAAE;YACtB,IAAI,CAAC,WAAW,EAAE,CAAC;YAEnB,IAAI,CAAC,wBAAwB,GAAG,UAAU,CAAC;gBACvC,SAAS,CAAC,IAAI,CAAC,wCAAwC,GAAG,KAAI,CAAC,oBAAoB,CAAC,CAAC;gBACrF,YAAY,CAAC,KAAI,CAAC,wBAAwB,CAAC,CAAC;gBAC5C,IAAI,MAAM,CAAC,GAAG,EAAE;oBACZ,MAAM,CAAC,GAAG,CAAC,KAAK,EAAE,MAAM,CAAC,CAAC;iBAC7B;gBACD,KAAI,CAAC,kBAAkB,CAAC,IAAI,EAAE,IAAI,CAAC,CAAC;YACxC,CAAC,EAAE,IAAI,CAAC,oBAAoB,CAAC,CAAC;YAE9B,SAAS,CAAC,IAAI,CAAC,+CAA+C,GAAG,IAAI,CAAC,qBAAqB,CAAC,CAAC;YAE7F,IAAI,CAAC,eAAe,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC;gBAC7B,SAAS,CAAC,IAAI,CAAC,yBAAyB,CAAC,CAAC;gBAC1C,KAAI,CAAC,WAAW,EAAE,CAAC;gBACnB,YAAY,CAAC,KAAI,CAAC,wBAAwB,CAAC,CAAC;YAChD,CAAC,CAAC,CAAC,KAAK,CAAC,UAAC,KAAU;gBAChB,SAAS,CAAC,IAAI,CAAC,0BAA0B,GAAG,IAAI,CAAC,SAAS,CAAC,KAAK,CAAC,CAAC,CAAC;gBACnE,KAAI,CAAC,WAAW,EAAE,CAAC;gBACnB,YAAY,CAAC,KAAI,CAAC,wBAAwB,CAAC,CAAC;gBAE5C,KAAI,CAAC,eAAe,CAAC,IAAI,EAAE,CAAC,IAAI,CAAC;oBAC7B,KAAI,CAAC,eAAe,CAAC,IAAI,EAAE,CAAC;gBAChC,CAAC,CAAC,CAAC,KAAK,CAAC;oBACL,KAAI,CAAC,iBAAiB,CAAC,KAAK,CAAC,CAAC;gBAClC,CAAC,CAAC,CAAC;YACP,CAAC,CAAC,CAAC;SACN;aAAM;YACH,IAAI,CAAC,mBAAmB,CAAC,IAAI,CAAC,CAAC;SAClC;IACL,CAAC;IAEM,gCAAkB,GAAzB,UAA0B,SAA0B,EAAE,aAA8B;QAA1D,0BAAA,EAAA,iBAA0B;QAAE,8BAAA,EAAA,qBAA8B;QAChF,IAAI,IAAI,CAAC,eAAe,IAAI,SAAS,EAAE;YACnC,IAAI,CAAC,eAAe,CAAC,OAAO,CAAC,IAAI,CAAC,mBAAmB,CAAC,CAAC;YACvD,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;YACzD,IAAI,CAAC,eAAe,CAAC,QAAQ,CAAC,IAAI,CAAC,oBAAoB,CAAC,CAAC;YACzD,IAAI,CAAC,eAAe,GAAG,IAAI,CAAC;SAC/B;QAED,IAAI,aAAa,EAAE;YACf,MAAM,CAAC,GAAG,GAAG,IAAI,CAAC;SACrB;QAED,IAAI,IAAI,CAAC,wBAAwB,EAAE;YAC/B,YAAY,CAAC,IAAI,CAAC,wBAAwB,CAAC,CAAC;SAC/C;QAED,IAAI,CAAC,WAAW,EAAE,CAAC;IACvB,CAAC;IAEM,6BAAe,GAAtB,cAAgC,CAAC;IAE1B,yBAAW,GAAlB,UAAmB,KAAa,EAAE,QAAkB,EAAE,KAAa,EAAE,IAAgB,EAAE,KAAsB;QAAxC,qBAAA,EAAA,QAAgB;QAAE,sBAAA,EAAA,aAAsB;QACzG,IAAI,QAAQ,EAAE;YACV,QAAQ,EAAE,CAAC;SACd;IACL,CAAC;IAEM,uBAAS,GAAhB,cAA0B,CAAC;IAEpB,+BAAiB,GAAxB,cAAkC,CAAC;IAE5B,uBAAS,GAAhB;QACI,OAAO,KAAK,CAAC;IACjB,CAAC;IAEM,4BAAc,GAArB;QACI,OAAO,KAAK,CAAC;IACjB,CAAC;IAEM,yBAAW,GAAlB,cAA4B,CAAC;IAEtB,yBAAW,GAAlB,cAA4B,CAAC;IAEtB,0BAAY,GAAnB,cAA6B,CAAC;IAEvB,wBAAU,GAAjB,cAA2B,CAAC;IAErB,yBAAW,GAAlB,UAAmB,KAAa,EAAE,QAAkB;QAChD,IAAI,QAAQ,EAAE;YACV,QAAQ,EAAE,CAAC;SACd;IACL,CAAC;IAEM,yBAAW,GAAlB,cAA4B,CAAC;IAErB,yBAAW,GAAnB;QACI,+BAA+B;IACnC,CAAC;IAEO,yBAAW,GAAnB;QACI,+BAA+B;IACnC,CAAC;IAzNgB,GAAG;QADvB,OAAO;OACa,GAAG,CA0NvB;IAAD,UAAC;CA1ND,AA0NC,IAAA;kBA1NoB,GAAG","file":"","sourceRoot":"/","sourcesContent":["const { ccclass } = cc._decorator;\n\n@ccclass\nexport default class PUC{\n    private env: any = null;\n    private bannerAd: any = null;\n    private rewardedVideoAd: any = null;\n    private rewardedVideoLoadTimeout: number = 0;\n    private rewardedVideoIAutoShow: boolean = false;\n    private rewardedVideoIsLoaded: boolean = false;\n    private rewardedVideoTimeMax: number = 30000;\n\n    public init(): void {\n        this.env = uc;\n    }\n\n    public initAD(): void {}\n\n    public loadBanner(show: boolean = false): void {\n        if (!this.bannerAd) {\n            const config = {\n                style: {\n                    width: lplatform.cparam.bannerWidth,\n                    height: lplatform.cparam.bannerHeight,\n                    gravity: 7\n                }\n            };\n            \n            this.bannerAd = uc.createBannerAd(config);\n            this.bannerAd.onLoad(() => {});\n            this.bannerAd.onError(() => {});\n            \n            if (show) {\n                this.bannerAd.show();\n            }\n        }\n    }\n\n    public showBanner(): void {\n        this.hideBanner();\n        if (this.bannerAd) {\n            this.bannerAd.show();\n        } else {\n            this.loadBanner(true);\n        }\n    }\n\n    public hideBanner(): void {\n        if (this.bannerAd) {\n            this.bannerAd.destroy();\n            this.bannerAd = null;\n        }\n    }\n\n    public hideInterstitial(): void {}\n\n    public createRewardedVideo(autoShow: boolean = false): void {\n        if (lplatform.cparam.rewardedVideoID) {\n            if (!this.rewardedVideoAd && typeof this.env.createRewardedVideoAd === 'function') {\n                this.rewardedVideoAd = this.env.createRewardedVideoAd({\n                    adUnitId: lplatform.cparam.rewardedVideoID\n                });\n                \n                this.rewardedVideoAd.onError(this.onRewardedVideoError.bind(this));\n                this.rewardedVideoAd.onClose(this.onRewardedVideoClose.bind(this));\n                this.rewardedVideoAd.onLoad(this.onRewardedVideoLoad.bind(this));\n            }\n            \n            if (autoShow) {\n                this.showRewardedVideo(window.vcb);\n            }\n        }\n    }\n\n    public loadRewardedVideo(autoShow: boolean = false): void {\n        this.createRewardedVideo(autoShow);\n        lplatform.plog(\"loadRewardedVideo this.rewardedVideoAd.load()\");\n    }\n\n    private onRewardedVideoLoad(): void {\n        lplatform.plog(\"onRewardedVideoLoad this.rewardedVideoIAutoShow:\" + this.rewardedVideoIAutoShow);\n    }\n\n    private onRewardedVideoError(error: any, message: string): void {\n        lplatform.plog(\"onRewardedVideoError code:\" + JSON.stringify(error) + \" msg:\" + message);\n        this.resetRewardedVideo();\n    }\n\n    private onRewardedVideoClose(result: any): void {\n        lplatform.plog(\"onRewardedVideoClose res.isEnded:\" + result.isEnded);\n        \n        if (result.isEnded) {\n            lplatform.plog(\"onRewardedVideoClose window.vcb:\" + window.vcb);\n            if (window.vcb) {\n                window.vcb(result.isEnded);\n            }\n            this.resetRewardedVideo(false, true);\n            this.loadRewardedVideo(false);\n        } else if (lplatform.labData.openSecondTipVideo) {\n            const self = this;\n            self.env.showModal({\n                title: \"继续吗\",\n                content: \"观看完视频才能获得奖励哦\",\n                success: function(response: any) {\n                    if (response.confirm) {\n                        self.showRewardedVideo(window.vcb);\n                    } else if (response.cancel) {\n                        if (window.vcb) {\n                            window.vcb(result.isEnded);\n                        }\n                        self.resetRewardedVideo(false, true);\n                        self.loadRewardedVideo(false);\n                    }\n                }\n            });\n        }\n    }\n\n    public showRewardedVideo(callback: Function): void {\n        lplatform.plog(\"showRewardedVideo vcb:\" + callback);\n        \n        if (callback) {\n            window.vcb = callback;\n        }\n        \n        if (this.rewardedVideoAd) {\n            this.showLoading();\n            \n            this.rewardedVideoLoadTimeout = setTimeout(() => {\n                lplatform.plog(\"rewardedVideoLoadTimeout 广告超时 timeMax:\" + this.rewardedVideoTimeMax);\n                clearTimeout(this.rewardedVideoLoadTimeout);\n                if (window.vcb) {\n                    window.vcb(false, \"广告超时\");\n                }\n                this.resetRewardedVideo(true, true);\n            }, this.rewardedVideoTimeMax);\n            \n            lplatform.plog(\"showRewardedVideo this.rewardedVideoIsLoaded:\" + this.rewardedVideoIsLoaded);\n            \n            this.rewardedVideoAd.show().then(() => {\n                lplatform.plog(\"showRewardedVideo then \");\n                this.hideLoading();\n                clearTimeout(this.rewardedVideoLoadTimeout);\n            }).catch((error: any) => {\n                lplatform.plog(\"showRewardedVideo catch:\" + JSON.stringify(error));\n                this.hideLoading();\n                clearTimeout(this.rewardedVideoLoadTimeout);\n                \n                this.rewardedVideoAd.load().then(() => {\n                    this.rewardedVideoAd.show();\n                }).catch(() => {\n                    this.loadRewardedVideo(false);\n                });\n            });\n        } else {\n            this.createRewardedVideo(true);\n        }\n    }\n\n    public resetRewardedVideo(destroyAd: boolean = false, clearCallback: boolean = false): void {\n        if (this.rewardedVideoAd && destroyAd) {\n            this.rewardedVideoAd.offLoad(this.onRewardedVideoLoad);\n            this.rewardedVideoAd.offError(this.onRewardedVideoError);\n            this.rewardedVideoAd.offClose(this.onRewardedVideoClose);\n            this.rewardedVideoAd = null;\n        }\n        \n        if (clearCallback) {\n            window.vcb = null;\n        }\n        \n        if (this.rewardedVideoLoadTimeout) {\n            clearTimeout(this.rewardedVideoLoadTimeout);\n        }\n        \n        this.hideLoading();\n    }\n\n    public shareAppMessage(): void {}\n\n    public makeShareUI(title: string, callback: Function, image: string, type: number = 0, force: boolean = false): void {\n        if (callback) {\n            callback();\n        }\n    }\n\n    public analytics(): void {}\n\n    public showFavoriteGuide(): void {}\n\n    public canRecord(): boolean {\n        return false;\n    }\n\n    public canShareRecord(): boolean {\n        return false;\n    }\n\n    public startRecord(): void {}\n\n    public pauseRecord(): void {}\n\n    public resumeRecord(): void {}\n\n    public stopRecord(): void {}\n\n    public shareRecord(title: string, callback: Function): void {\n        if (callback) {\n            callback();\n        }\n    }\n\n    public resetRecord(): void {}\n\n    private showLoading(): void {\n        // Implement loading show logic\n    }\n\n    private hideLoading(): void {\n        // Implement loading hide logic\n    }\n}"]}