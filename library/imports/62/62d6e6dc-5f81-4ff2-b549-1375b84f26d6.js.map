{"version":3,"sources":["assets/Scripts/Common_CommonUtil.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\nimport { GameBundle } from \"./GameData\";\n\n@ccclass\nexport default class Common_CommonUtil {\n    \n    public static isWeChat(): boolean {\n        return cc.sys.platform === cc.sys.WECHAT_GAME;\n    }\n\n    public static showTips(text: string, duration?: number): void {\n        GameBundle[3].load(\"GameRes3/common/prefabs/h5game_Tips\", (err: Error, prefab: cc.Prefab) => {\n            if (err) {\n                cc.error(err);\n                return;\n            }\n            const tipsNode = cc.instantiate(prefab);\n            tipsNode.getComponent(\"h5game_Tips\").setText(text, duration);\n            tipsNode.parent = cc.director.getScene();\n        });\n    }\n\n    public static showShareFailTips(): void {\n        this.getPrefab(\"prefabs/n_sharebubble\", (node: cc.Node) => {\n            node.parent = cc.find(\"Canvas\") || cc.director.getScene().children[0];\n            node.zIndex = 2048;\n        });\n    }\n\n    public static shakeScreen(target: cc.Node, duration: number = 0.02, intensity: number = 10): void {\n        target.stopAllActions();\n        target.runAction(cc.sequence(\n            cc.moveBy(duration, cc.v2(2 * intensity, 0)),\n            cc.moveBy(2 * duration, cc.v2(4 * -intensity, 0)),\n            cc.moveBy(duration, cc.v2(2 * intensity, 0)),\n            cc.moveBy(duration, cc.v2(0, 2 * intensity)),\n            cc.moveBy(2 * duration, cc.v2(0, 4 * -intensity)),\n            cc.moveBy(duration, cc.v2(0, 2 * intensity)),\n            cc.moveBy(duration, cc.v2(intensity, 0)),\n            cc.moveBy(2 * duration, cc.v2(2 * -intensity, 0)),\n            cc.moveBy(duration, cc.v2(intensity, 0)),\n            cc.moveBy(duration, cc.v2(0, intensity)),\n            cc.moveBy(2 * duration, cc.v2(0, 2 * -intensity)),\n            cc.moveBy(duration, cc.v2(0, intensity))\n        ));\n    }\n\n    public static fitScreen(): void {\n        const canvas = cc.director.getScene().getComponentInChildren(cc.Canvas);\n        const visibleSize = cc.view.getVisibleSize();\n        \n        if (visibleSize.width / visibleSize.height < 9 / 16) {\n            canvas.fitWidth = true;\n            canvas.fitHeight = false;\n        } else {\n            canvas.fitWidth = false;\n            canvas.fitHeight = true;\n        }\n    }\n\n    public static resetScale(node: cc.Node): void {\n        const visibleSize = cc.view.getVisibleSize();\n        if (visibleSize.width / visibleSize.height < 9 / 16) {\n            node.scale = visibleSize.width / 1080;\n        } else {\n            node.scale = visibleSize.height / 1920;\n        }\n    }\n\n    public static imgStr(str: string): string {\n        return str;\n    }\n\n    public static txtStr(str: string): string {\n        return str;\n    }\n\n    public static setSprite(target: cc.Sprite | cc.Node | string, path: string = \"\", callback?: Function): void {\n        if (!target) {\n            throw new Error(\"请传入正确的节点名称\");\n        }\n        if (!path) {\n            throw new Error(\"请传入正确的资源路径\");\n        }\n\n        let sprite: cc.Sprite;\n        \n        if (target instanceof cc.Sprite) {\n            sprite = target;\n        } else if (target instanceof cc.Node) {\n            sprite = target.getComponent(cc.Sprite);\n        } else if (typeof target === \"string\") {\n            sprite = cc.find(target).getComponent(cc.Sprite);\n        } else {\n            throw new Error(\"传入节点资源类型不正确\");\n        }\n\n        if (!sprite) {\n            throw new Error(\"未找到正确的Sprite\");\n        }\n\n        if (sprite && sprite.spriteFrame) {\n            const originalOpacity = sprite.node.opacity;\n            sprite.node.opacity = 0;\n\n            const loadMethod = path.indexOf(\"http\") !== 0 ? \"loadRes\" : \"load\";\n            \n            cc.loader[loadMethod](path, (err: Error, texture: cc.Texture2D) => {\n                if (err) {\n                    cc.error(err.message || err);\n                    return;\n                }\n                sprite.spriteFrame = new cc.SpriteFrame(texture);\n                sprite.node.opacity = originalOpacity;\n                callback && callback();\n            });\n        }\n    }\n\n    public static getPrefab(path: string, callback: (node: cc.Node) => void): void {\n        GameBundle[3].load(\"GameRes3/\" + path, (err: Error, prefab: cc.Prefab) => {\n            if (err) {\n                throw err;\n            }\n            callback(cc.instantiate(prefab));\n        });\n    }\n\n    public static setAvatarSprite(target: cc.Sprite | cc.Node, avatarUrl: string): void {\n        let sprite: cc.Sprite = null;\n        \n        if (target instanceof cc.Sprite) {\n            sprite = target;\n        } else if (target instanceof cc.Node) {\n            sprite = target.getComponent(cc.Sprite);\n        }\n\n        if (!sprite) {\n            throw new Error(\"CommonUtil.setSprite: 无法找到正确的Sprite\");\n        }\n\n        const image = wx.createImage();\n        image.onload = () => {\n            const texture = new cc.Texture2D();\n            texture.initWithElement(image);\n            texture.handleLoadedTexture();\n            sprite.spriteFrame = new cc.SpriteFrame(texture);\n        };\n        image.src = avatarUrl;\n    }\n}"]}