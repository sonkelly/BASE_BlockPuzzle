{"version":3,"sources":["assets/Scripts/MenuScene.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\nimport Common from \"./Common\";\nimport AudioManager, {AudioID} from \"./AudioManager\";\nimport EventManager from \"./EventManager\";\nimport { CHANNEL } from \"./PlatformA\";\nimport { MODE, GameMode } from \"./Property\";\nimport { GameData, GameBundle } from \"./GameData\";\nimport Utils from \"./Utils\";\n\n@ccclass\nexport default class MenuScene extends cc.Component {\n    @property([cc.Label])\n    modeBestScore: cc.Label[] = [];\n\n    @property(cc.Node)\n    soundSprite: cc.Node = null;\n\n    onLoad() {\n        \n        this.initialSound();\n        this.initialModeScore();\n    }\n\n    start() {\n        EventManager.instance.EventMenu();\n        \n        if (lplatform.channel == CHANNEL.tt) {\n            cc.find(\"Canvas/topnode/btn_set/btnPrivacyPolicy\").active = false;\n            cc.find(\"Canvas/topnode/btn_set/btnUserAgreement\").active = false;\n        }\n    }\n\n    initialModeScore() {\n        const modeKeys = Object.keys(MODE);\n        \n        for (let t = 0; t < this.modeBestScore.length; t++) {\n            const mode = MODE[modeKeys[t]];\n            \n            if (mode == MODE.JIEMI || mode == MODE.CHUANGGUAN) {\n                this.modeBestScore[t].string = GameData.level[mode] || \"1\";\n            } else if (mode == MODE.STAR) {\n                const userData = cc.sys.localStorage.getItem(\"userData_xmxx\");\n                if (userData && userData != \"\") {\n                    const data = JSON.parse(userData);\n                    this.modeBestScore[t].string = data && data.num_score_best ? data.num_score_best.toString() : \"0\";\n                } else {\n                    this.modeBestScore[t].string = \"0\";\n                }\n            } else if (mode == MODE.KILL) {\n                window.tempFileURL = [\"\", \"\", \"\"];\n                \n                const guideInfo = cc.sys.localStorage.getItem(\"guideinfo\");\n                window.GUIDE_LEVEL = guideInfo && guideInfo != \"null\" ? 1 : 0;\n                \n                const savedData = cc.sys.localStorage.getItem(window.GAME_SAVE_HANDLER);\n                if (savedData) {\n                    window.INIT_GAME_SAVE_DATA = JSON.parse(savedData);\n                    this.modeBestScore[t].string = (Number(window.INIT_GAME_SAVE_DATA.top_level) + 1).toString();\n                } else {\n                    cc.sys.localStorage.setItem(window.GAME_SAVE_HANDLER, JSON.stringify(window.INIT_GAME_SAVE_DATA));\n                    this.modeBestScore[t].string = \"1\";\n                }\n                \n                GameBundle[3].load(\"GameRes3/level_config2\", (err: any, asset: any) => {\n                    if (err) {\n                        cc.error(err.message || err);\n                    } else {\n                        window.MAP_CONFIG = asset.json;\n                    }\n                });\n            } else {\n                this.modeBestScore[t].string = GameData.getBestScore(mode).toString();\n            }\n            \n            const videoIcon = this.modeBestScore[t].node.parent.getChildByName(\"icon_video\");\n            if (videoIcon) {\n                videoIcon.active = !GameData.modeLock[mode];\n            }\n        }\n    }\n\n    initialSound() {\n        if (GameData.audioSwitch == 1) {\n            AudioManager.instance.playBgMusic();\n        }\n        this.soundSprite.active = GameData.audioSwitch == 0;\n    }\n\n    onClickMode(event: cc.Event, customEventData: string) {\n        const modeIndex = parseInt(customEventData);\n        AudioManager.instance.playSound(AudioID.ClickMode);\n        \n        const modeKeys = Object.keys(MODE);\n        GameMode = MODE[modeKeys[modeIndex]];\n        console.log(GameMode);\n        \n        if (GameMode == MODE.TEACH) {\n            if (GameData.teachingXS == 3) {\n                GameData.teachingXS = 0;\n                GameData.saveData();\n            }\n            this.toGame();\n        } else if (GameMode == MODE.JINGDIAN) {\n            this.toGame();\n        } else {\n            console.log(\"GameData.modeLock\", GameData.modeLock[GameMode]);\n            if (GameData.modeLock[GameMode]) {\n                this.toGame();\n            } else {\n                EventManager.instance.showRewardedVideo(() => {\n                    GameData.modeLock[GameMode] = 1;\n                    GameData.teaching = 3;\n                    GameData.saveData();\n                    this.toGame();\n                });\n            }\n        }\n    }\n\n    onClickQiDai() {\n        AudioManager.instance.playSound(AudioID.ClickMode);\n        Utils.ShowAsk(\"Coming Soon...\");\n    }\n\n    toGame() {\n        AudioManager.instance.pauseMusic();\n        EventManager.instance.EventMenuToGame();\n        Common.instance.toGame();\n        EventManager.instance.gameEvent(\"GameMode\", GameMode);\n    }\n\n    onClickSetAudio() {\n        GameData.audioSwitch = 1 - GameData.audioSwitch;\n        AudioManager.instance.playClickSound();\n        \n        if (GameData.audioSwitch == 0) {\n            AudioManager.instance.pauseMusic();\n        } else {\n            AudioManager.instance.resumeMusic();\n        }\n        \n        this.soundSprite.active = GameData.audioSwitch == 0;\n    }\n}"]}