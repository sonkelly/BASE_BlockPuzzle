{"version":3,"sources":["assets/Scripts/EventManager.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\nimport { CHANNEL } from \"./PlatformA\";\nimport { Property } from \"./Property\";\n@ccclass\nexport default class EventManager extends cc.Component {\n    private static _instance: EventManager = new EventManager();\n    \n    public static get instance(): EventManager {\n        return this._instance;\n    }\n\n    onLoad() {\n        if (EventManager._instance === null) {\n            EventManager._instance = this;\n        }\n    }\n\n    EventLoad(): void {\n        switch (lplatform.channel) {\n            case CHANNEL.oppo:\n            case CHANNEL.qq:\n            case CHANNEL.android:\n                this.WhileBanner();\n                break;\n            case CHANNEL.ios:\n                Property.PUSH_ZJD_TIME_INTERVAL = 180;\n                Property.PUSH_ZJD_TIME = 180;\n                this.WhileBanner();\n                break;\n        }\n    }\n\n    WhileBanner(): void {\n        console.log(\"WhileBanner\", lplatform.labData.bannerRefresh);\n        this.showBanner();\n        \n        if (lplatform.labData.bannerRefresh != null) {\n            this.scheduleOnce(() => {\n                this.WhileBanner();\n            }, lplatform.labData.bannerRefresh);\n        } else {\n            this.scheduleOnce(() => {\n                this.WhileBanner();\n            }, 30);\n        }\n    }\n\n    EventMenu(): void {\n        switch (lplatform.channel) {\n            case CHANNEL.vivo:\n                this.moreGame();\n                this.showBanner();\n                break;\n            case CHANNEL.tt:\n                this.showBanner();\n                break;\n            case CHANNEL.miniGame:\n                this.hideBanner();\n                this.showBanner();\n                break;\n        }\n    }\n\n    EventMenuToGame(): void {\n        switch (lplatform.channel) {\n            case CHANNEL.tt:\n                this.hideBanner();\n                this.startRecord();\n                break;\n            case CHANNEL.oppo:\n            case CHANNEL.vivo:\n            case CHANNEL.qq:\n                if (lplatform.labData.sendToTable && lplatform.labData.sendToTable == 1) {\n                    this.showFavoriteGuide();\n                }\n                break;\n        }\n    }\n\n    EventInterstitial(): void {\n        console.log(\"EventInterstitial\");\n        \n        switch (lplatform.channel) {\n            case CHANNEL.oppo:\n            case CHANNEL.vivo:\n            case CHANNEL.qq:\n            case CHANNEL.tt:\n            case CHANNEL.android:\n            case CHANNEL.android233:\n                console.log(\"AllInter\", lplatform.labData.allInter);\n                if (!lplatform.labData.allInter || lplatform.labData.allInter != 1) {\n                    return;\n                }\n                this.showInterstitial();\n                break;\n            case CHANNEL.ios:\n                window.iosInterstitialDelay = window.iosInterstitialDelay || 0;\n                window.iosInterstitialDelay++;\n                if (window.iosInterstitialDelay >= 3) {\n                    window.iosInterstitialDelay = 0;\n                    lplatform.showInterstitial();\n                }\n                break;\n            case CHANNEL.miniGame:\n                this.showInterstitial();\n                break;\n        }\n    }\n\n    EventInterstitialVideo(): void {\n        console.log(\"EventManager===>>>\", \"EventInterstitialVideo\");\n        \n        switch (lplatform.channel) {\n            case CHANNEL.android233:\n                console.log(\"AllInter\", lplatform.labData.allInter);\n                if (!lplatform.labData.allInter || lplatform.labData.allInter != 1) {\n                    return;\n                }\n                lplatform.showInterstitialVideo();\n                break;\n            case CHANNEL.ios:\n                lplatform.showInterstitial();\n                break;\n        }\n    }\n\n    EventWinAndFail(): void {\n        switch (lplatform.channel) {\n            case CHANNEL.tt:\n                this.stopRecord();\n                break;\n        }\n    }\n\n    showBanner(): void {\n        if (!window.MiniGameAds) return;\n        \n        if (MiniGameAds.isBannerReady()) {\n            MiniGameAds.showBanner()\n                .then(() => {\n                    console.info(\"新接口播放横幅广告: 成功\");\n                })\n                .catch((error: any) => {\n                    console.error(\"新接口播放横幅广告: 失败，原因: \" + error.message);\n                });\n        } else {\n            console.info(\"横幅广告没有加载成功，无法播放\");\n        }\n    }\n\n    hideBanner(): void {\n        if (!window.MiniGameAds) return;\n        \n        MiniGameAds.hideBanner()\n            .then(() => {\n                console.info(\"新接口隐藏激励广告: 成功\");\n            })\n            .catch((error: any) => {\n                console.error(\"新接口隐藏激励广告: 失败，原因: \" + error.message);\n            });\n    }\n\n    showInterstitial(): void {\n        if (!window.MiniGameAds) return;\n        \n        if (MiniGameAds.isInterstitialReady()) {\n            MiniGameAds.showInterstitial()\n                .then(() => {\n                    console.info(\"新接口播放插屏广告: 成功\");\n                })\n                .catch((error: any) => {\n                    console.error(\"新接口播放插屏广告: 失败，原因: \" + error.message);\n                });\n        } else {\n            console.info(\"插屏广告没有加载成功，无法播放\");\n        }\n    }\n\n    showRewardedVideo(callback?: Function): void {\n        if (!window.MiniGameAds) {\n            callback && callback();\n            return;\n        }\n        \n        if (MiniGameAds.isRewardvideoReady()) {\n            this.audioManager.pauseMusic();\n            \n            MiniGameAds.showRewardedVideo()\n                .then(() => {\n                    console.info(\"新接口播放激励广告: 成功\");\n                    callback && callback();\n                    this.audioManager.resumeMusic();\n                })\n                .catch((error: any) => {\n                    console.error(\"新接口播放激励广告: 失败，原因: \" + error.message);\n                    this.audioManager.resumeMusic();\n                });\n        } else {\n            console.info(\"激励视频没有加载成功，无法播放\");\n        }\n    }\n\n    gameEvent(event: string, data: any): void {\n        console.log(\"gameEvent===>>>\", event, data);\n        if (window.MiniGameAnalytics) {\n            MiniGameAnalytics.onGameEvent(event, data);\n        }\n    }\n\n    canRecord(): void {\n        lplatform.canRecord();\n    }\n\n    startRecord(): void {\n        lplatform.startRecord();\n    }\n\n    stopRecord(): void {\n        lplatform.stopRecord();\n    }\n\n    shareRecord(): void {\n        lplatform.shareRecord();\n    }\n\n    showFavoriteGuide(): void {\n        lplatform.showFavoriteGuide();\n    }\n\n    moreGame(): void {\n        // 需要在具体平台实现\n    }\n}"]}