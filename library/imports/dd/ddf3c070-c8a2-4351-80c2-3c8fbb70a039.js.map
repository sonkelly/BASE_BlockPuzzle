{"version":3,"sources":["assets/Scripts/block.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\nimport ExtendScript from \"./ExtendScript\";\nimport AudioManager, { AudioID } from \"./AudioManager\";\nimport ResourceUtil from \"./resourceUtil\";\nimport clientEvent from \"./clientEvent\";\nimport Common from \"./Common\";\nimport { MODE, GameMode } from \"./Property\";\nimport Utils from \"./Utils\";\nimport _ from \"./lodash\";\n\n@ccclass\nexport default class block extends ExtendScript {\n    @property\n    private _move: number = 0;\n    \n    @property\n    private _cType: number = -1;\n    \n    @property\n    iceNum: number = 1;\n    \n    @property(cc.Sprite)\n    iceSprite: cc.Sprite = null;\n    \n    @property([cc.SpriteFrame])\n    cgSpf: cc.SpriteFrame[] = [];\n    \n    private index: number = 0;\n    private isChange: boolean = false;\n    private isIceBlock: boolean = false;\n\n    onLoad() {\n    }\n\n    initial(e: number): void {\n        this.index = 0;\n        this._cType = e;\n        this.isChange = false;\n        this.setSprite(e);\n    }\n\n    modeCGInitial(e: any): void {\n        this.isChange = false;\n        this.iceNum = e.num;\n        this.isIceBlock = true;\n        this.setSprite(\"_cg_flower\");\n        this.setIceSprite(e.num - 1);\n    }\n\n    getIsIce(): boolean {\n        return this.isIceBlock;\n    }\n\n    getXcNumber(): number {\n        return this.iceNum;\n    }\n\n    setIceSprite(e: number): void {\n        if (this.iceSprite && this.cgSpf[e]) {\n            this.iceSprite.spriteFrame = this.cgSpf[e];\n        }\n    }\n\n    setIceNumber(e: number, t?: Function): void {\n        const self = this;\n        this.isChange = false;\n        this.iceNum = e;\n        \n        if (e > 0) {\n            this.setIceSprite(e - 1);\n        }\n        \n        Common.instance.showBlockBoom(this.node, this.getXcNumber(), function() {\n            if (e <= 0) {\n                if (t) {\n                    t();\n                }\n                self.clean();\n            }\n        });\n    }\n\n    setSprite(e: any): void {\n        if (e != null) {\n            const t = this.node.getComponent(cc.Sprite);\n            if (e == -1) {\n                t.enabled = false;\n            } else {\n                ResourceUtil.instance.setSpriteFrame(\"kuai/k\" + e, t);\n            }\n        }\n    }\n\n    setGray(e: number): void {\n        const t = this.node.getComponent(cc.Sprite);\n        this.scheduleOnce(() => {\n            ResourceUtil.instance.setSpriteFrame(\"kuai/huiKuai\", t);\n            clientEvent.dispatchEvent(\"setGray\");\n        }, e);\n    }\n\n    setChange(e: number): void {\n        this.isChange = true;\n        \n        // Assuming GameMode and MODE are defined elsewhere\n        if (GameMode == MODE.CHUANGGUAN && this.iceNum >= 2) {\n            return;\n        }\n        \n        const t = this.node.getComponent(cc.Sprite);\n        ResourceUtil.instance.setSpriteFrame(\"kuai/k\" + e, t);\n    }\n\n    playDragon(e: any, t: number): void {\n        const self = this;\n        this.isChange = false;\n        this.scheduleOnce(() => {\n            self.playAni(e);\n        }, t);\n    }\n\n    playAni(e: any): void {\n        const self = this;\n        AudioManager.instance.playSound(AudioID.BCrazing);\n        \n        const o = this.node.parent.convertToWorldSpaceAR(cc.v2(0, 0));\n        const tempNode = cc.find(\"Canvas/uiRoot/tempNode\");\n        this.node.parent = tempNode;\n        this.node.position = tempNode.convertToNodeSpaceAR(o);\n        \n        this.node.getComponent(cc.Sprite).spriteFrame = null;\n        \n        const dbNode = this.node.getChildByName(\"db\");\n        if (dbNode) {\n            const n = dbNode.getComponent(dragonBones.ArmatureDisplay);\n            n.node.active = true;\n            \n            const i = [\"x1\", \"s15\", \"s11\", \"s13\", \"s12\", \"s14\", \"g1\", \"x11\", \"x12\", \"s141\", \"s151\", \"s111\", \"x121\", \"x111\", \"x13\"];\n            for (let r = 0; r < i.length; r++) {\n                Utils.setSolt(n, i[r], e);\n            }\n            \n            const s = _.random(1, 4);\n            \n            Utils.addSoundEvent(n);\n            Utils.playAniCall(n, \"newAnimation\" + s, function() {\n                self.clean();\n            });\n        }\n    }\n\n    clean(): void {\n        this.node.destroy();\n    }\n}"]}