{"version":3,"sources":["assets/Scripts/SkinItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["import EventListener from \"./event_listener\";\n\nconst { ccclass, property } = cc._decorator;\n\n@ccclass\nexport default class SkinItem extends cc.Component {\n    @property(cc.Label)\n    m_l_goldlabel: cc.Label = null;\n\n    @property(cc.Sprite)\n    m_sp_blockstyle: cc.Sprite = null;\n\n    @property(cc.Node)\n    m_n_isready: cc.Node = null;\n\n    @property(cc.Button)\n    m_btn_suitup: cc.Button = null;\n\n    @property(cc.Label)\n    m_l_sharetext: cc.Label = null;\n\n    private _data: any = null;\n    private _state: number = 0;\n    private _index: number = 0;\n    private _onshowback: boolean = false;\n\n    start(): void {\n        EventListener.instance.on(window.ON_SHOW_BACK, this.onshowback, this);\n    }\n\n    onDestroy(): void {\n        EventListener.instance.off(window.ON_SHOW_BACK, this);\n    }\n\n    updateData(index: number, data: any, spriteFrame: cc.SpriteFrame): void {\n        this._index = index;\n        this._data = data;\n        const skinData = window.INIT_GAME_SAVE_DATA.skin[index];\n        this._state = skinData || 0;\n\n        this.m_sp_blockstyle.spriteFrame = spriteFrame;\n        this.m_n_isready.active = this._state >= 2;\n        this.m_btn_suitup.node.active = this._state < 2;\n        this.m_l_goldlabel.string = data.price.toString();\n\n        if (this._state === 0) {\n            if (data.way === 1 && window.SKIN_SHARE) {\n                this.m_l_sharetext.node.active = true;\n                this.m_l_goldlabel.node.parent.active = false;\n                this.m_btn_suitup.interactable = true;\n            } else {\n                this.m_l_sharetext.node.active = false;\n                this.m_l_goldlabel.node.parent.active = true;\n                this.m_btn_suitup.interactable = window.INIT_GAME_SAVE_DATA.gold_num >= data.price;\n            }\n            this.m_btn_suitup.node.y = -145;\n        } else if (this._state === 1) {\n            this.m_l_sharetext.node.active = false;\n            this.m_l_goldlabel.node.parent.active = false;\n            this.m_btn_suitup.interactable = true;\n            this.m_btn_suitup.node.y = -74;\n        } else {\n            this.m_l_sharetext.node.active = false;\n            this.m_l_goldlabel.node.parent.active = false;\n        }\n    }\n\n    onshowback(count: number): void {\n        if (this._onshowback) {\n            if (count >= window.SHARE_TIME) {\n                this.onSuitUp();\n            } else {\n                // Assuming Common_CommonUtil is imported as CommonUtil\n                CommonUtil.showShareFailTips();\n            }\n            this._onshowback = false;\n        }\n    }\n\n    onSuitUp(): void {\n        if (!this.m_btn_suitup.interactable) return;\n\n        const skinData = window.INIT_GAME_SAVE_DATA.skin;\n        for (let i = 0; i < skinData.length; i++) {\n            if (skinData[i] === 2) {\n                skinData[i] = 1;\n                skinData[this._index] = 2;\n                break;\n            }\n        }\n\n        if (this._state === 0) {\n            if (this._data.way !== 0 && window.SKIN_SHARE) {\n                this._onshowback = true;\n                // Assuming ShareSdk is imported\n                ShareSdk.shareAppMessage({\n                    title: \"获得了一个怪兽皮肤，快来看看吧\",\n                    imageUrl: window.tempFileURL[1]\n                });\n            } else {\n                window.INIT_GAME_SAVE_DATA.gold_num -= this._data.price;\n                EventListener.instance.fire(window.GAME_UPDATE_DATA);\n            }\n        }\n\n        EventListener.instance.fire(window.GAME_SAVE_HANDLER);\n    }\n}"]}