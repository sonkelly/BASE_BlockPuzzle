{"version":3,"sources":["assets/Scripts/GameStep.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;AAAM,IAAA,KAAwB,EAAE,CAAC,UAAU,EAAnC,OAAO,aAAA,EAAE,QAAQ,cAAkB,CAAC;AAC5C,2CAAsC;AAGtC;IAAsC,4BAAY;IAAlD;QAAA,qEAiGC;QA/FG,gBAAU,GAAmB,IAAI,CAAC;QAGlC,wBAAkB,GAAY,IAAI,CAAC;QAGnC,qBAAe,GAAc,IAAI,CAAC;QAGlC,qBAAe,GAAc,IAAI,CAAC;QAGlC,oBAAc,GAAc,EAAE,CAAC;QAG/B,mBAAa,GAAc,IAAI,CAAC;QAExB,gBAAU,GAAQ,IAAI,CAAC;;IA8EnC,CAAC;IA5EG,wBAAK,GAAL;QACI,IAAM,SAAS,GAAG,oBAAU,CAAC,WAAW,CAAC,MAAM,CAAC;QAChD,IAAI,CAAC,kBAAkB,CAAC,MAAM,GAAG,GAAG,GAAG,SAAS,GAAG,EAAE,GAAG,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC;QAExE,KAAK,IAAI,CAAC,GAAG,SAAS,GAAG,CAAC,EAAE,CAAC,GAAG,CAAC,EAAE,CAAC,IAAI,CAAC,EAAE,CAAC,EAAE,EAAE;YAC5C,IAAM,IAAI,GAAG,EAAE,CAAC,WAAW,CAAC,IAAI,CAAC,aAAa,CAAC,CAAC;YAChD,IAAI,CAAC,CAAC,GAAG,CAAC,CAAC;YACX,IAAI,CAAC,CAAC,GAAG,CAAC,EAAE,GAAG,CAAC,SAAS,GAAG,CAAC,GAAG,CAAC,CAAC,GAAG,CAAC,IAAI,CAAC,MAAM,GAAG,EAAE,CAAC,CAAC;YACxD,IAAI,CAAC,kBAAkB,CAAC,QAAQ,CAAC,IAAI,CAAC,CAAC;YAEvC,IAAM,UAAU,GAAG,oBAAU,CAAC,WAAW,CAAC,CAAC,CAAC,CAAC;YAC7C,IAAM,UAAU,GAAG,CAAC,GAAG,CAAC,CAAC;YACzB,IAAM,WAAW,GAAG,IAAI,CAAC,YAAY,CAAC,aAAa,CAAC,CAAC;YACrD,WAAW,CAAC,UAAU,CAClB,UAAU,EACV,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,UAAU,CAAC,SAAS,CAAC,EACpD,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,UAAU,CAAC,SAAS,CAAC,EACpD,MAAM,CAAC,mBAAmB,CAAC,SAAS,EACpC,UAAU,CACb,CAAC;YACF,CAAC,EAAE,CAAC;SACP;QAED,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,MAAM,CAAC,YAAY,CAAC,EAAE,CAAC,UAAU,CAAC,CAAC,cAAc,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC,EAAE,IAAI,CAAC,kBAAkB,CAAC,MAAM,CAAC,CAAC,CAAC;QAC3H,IAAI,CAAC,UAAU,EAAE,CAAC;IACtB,CAAC;IAED,gCAAa,GAAb;QACI,kCAAkC;IACtC,CAAC;IAED,6BAAU,GAAV;QACI,IAAM,QAAQ,GAAG,MAAM,CAAC,mBAAmB,CAAC,SAAS,CAAC;QACtD,IAAM,QAAQ,GAAG,IAAI,CAAC,aAAa,CAAC,QAAQ,CAAC,CAAC;QAE9C,IAAI,QAAQ,EAAE;YACV,IAAI,CAAC,eAAe,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;YACtF,IAAI,CAAC,eAAe,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,QAAQ,CAAC,SAAS,CAAC,CAAC;YAEtF,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACjD,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,GAAG,QAAQ,CAAC,IAAI,CAAC;aACrD;SACJ;aAAM;YACH,IAAI,CAAC,eAAe,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;YAC/E,IAAI,CAAC,eAAe,CAAC,WAAW,GAAG,IAAI,CAAC,UAAU,CAAC,cAAc,CAAC,WAAW,CAAC,CAAC;YAE/E,KAAK,IAAI,CAAC,GAAG,CAAC,EAAE,CAAC,GAAG,IAAI,CAAC,cAAc,CAAC,MAAM,EAAE,CAAC,EAAE,EAAE;gBACjD,IAAI,CAAC,cAAc,CAAC,CAAC,CAAC,CAAC,MAAM,GAAG,CAAC,IAAI,CAAC,CAAC;aAC1C;SACJ;IACL,CAAC;IAED,6BAAU,GAAV;QACI,MAAM,CAAC,cAAc,CAAC,MAAM,CAAC,kBAAkB,EAAE,KAAK,EAAE,CAAC,CAAC,CAAC;QAC3D,EAAE,CAAC,QAAQ,CAAC,SAAS,CAAC,MAAM,CAAC,eAAe,CAAC,CAAC;IAClD,CAAC;IAED,gCAAa,GAAb,UAAc,KAAa;QACvB,IAAI,SAAS,GAAG,IAAI,CAAC,KAAK,CAAC,KAAK,GAAG,EAAE,CAAC,CAAC;QAEvC,IAAI,SAAS,IAAI,CAAC,EAAE;YAChB,OAAO,IAAI,CAAC;SACf;QAED,IAAI,SAAS,GAAG,oBAAU,CAAC,WAAW,CAAC,MAAM,EAAE;YAC3C,SAAS,GAAG,oBAAU,CAAC,WAAW,CAAC,MAAM,CAAC;SAC7C;QAED,OAAO,oBAAU,CAAC,WAAW,CAAC,SAAS,GAAG,CAAC,CAAC,CAAC;IACjD,CAAC;IAED,4BAAS,GAAT;QACI,IAAI,IAAI,CAAC,UAAU,EAAE;YACjB,IAAI,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;SAC3B;IACL,CAAC;IA9FD;QADC,QAAQ,CAAC,EAAE,CAAC,WAAW,CAAC;gDACS;IAGlC;QADC,QAAQ,CAAC,EAAE,CAAC,IAAI,CAAC;wDACiB;IAGnC;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;qDACc;IAGlC;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;qDACc;IAGlC;QADC,QAAQ,CAAC,CAAC,EAAE,CAAC,IAAI,CAAC,CAAC;oDACW;IAG/B;QADC,QAAQ,CAAC,EAAE,CAAC,MAAM,CAAC;mDACY;IAjBf,QAAQ;QAD5B,OAAO;OACa,QAAQ,CAiG5B;IAAD,eAAC;CAjGD,AAiGC,CAjGqC,EAAE,CAAC,SAAS,GAiGjD;kBAjGoB,QAAQ","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\nimport ConstValue from \"./ConstValue\";\n\n@ccclass\nexport default class GameStep extends cc.Component {\n    @property(cc.SpriteAtlas)\n    m_spa_list: cc.SpriteAtlas = null;\n\n    @property(cc.Node)\n    m_n_bigstepcontent: cc.Node = null;\n\n    @property(cc.Sprite)\n    m_sp_mystepicon: cc.Sprite = null;\n\n    @property(cc.Sprite)\n    m_sp_mystepname: cc.Sprite = null;\n\n    @property([cc.Node])\n    m_n_mystarlist: cc.Node[] = [];\n\n    @property(cc.Prefab)\n    m_pre_bigstep: cc.Prefab = null;\n\n    private m_nodepoll: any = null;\n\n    start() {\n        const stepCount = ConstValue.STEP_CONFIG.length;\n        this.m_n_bigstepcontent.height = 115 * stepCount + 20 * (stepCount - 1);\n        \n        for (let i = stepCount - 1, e = 0; i >= 0; i--) {\n            const node = cc.instantiate(this.m_pre_bigstep);\n            node.x = 0;\n            node.y = -62 - (stepCount - i - 1) * (node.height + 20);\n            this.m_n_bigstepcontent.addChild(node);\n            \n            const stepConfig = ConstValue.STEP_CONFIG[i];\n            const colorIndex = e % 4;\n            const bigStepItem = node.getComponent(\"BigStepItem\");\n            bigStepItem.updateData(\n                stepConfig,\n                this.m_spa_list.getSpriteFrame(stepConfig.icon_path),\n                this.m_spa_list.getSpriteFrame(stepConfig.desc_path),\n                window.INIT_GAME_SAVE_DATA.top_level,\n                colorIndex\n            );\n            e++;\n        }\n        \n        this.m_n_bigstepcontent.parent.parent.getComponent(cc.ScrollView).scrollToOffset(cc.v2(0, this.m_n_bigstepcontent.height));\n        this.initMyData();\n    }\n\n    onToggleClick(): void {\n        // Implementation for toggle click\n    }\n\n    initMyData(): void {\n        const topLevel = window.INIT_GAME_SAVE_DATA.top_level;\n        const stepData = this.getMyStepData(topLevel);\n        \n        if (stepData) {\n            this.m_sp_mystepicon.spriteFrame = this.m_spa_list.getSpriteFrame(stepData.icon_path);\n            this.m_sp_mystepname.spriteFrame = this.m_spa_list.getSpriteFrame(stepData.desc_path);\n            \n            for (let i = 0; i < this.m_n_mystarlist.length; i++) {\n                this.m_n_mystarlist[i].active = i < stepData.star;\n            }\n        } else {\n            this.m_sp_mystepicon.spriteFrame = this.m_spa_list.getSpriteFrame(\"stepicon6\");\n            this.m_sp_mystepname.spriteFrame = this.m_spa_list.getSpriteFrame(\"stepname6\");\n            \n            for (let i = 0; i < this.m_n_mystarlist.length; i++) {\n                this.m_n_mystarlist[i].active = i <= 0;\n            }\n        }\n    }\n\n    onBackHome(): void {\n        Utils3.SetSoundEffect(window.BUTTON_CLICK_MUSIC, false, 1);\n        cc.director.loadScene(window.HALL_SCENE_NAME);\n    }\n\n    getMyStepData(level: number): any {\n        let stepIndex = Math.floor(level / 10);\n        \n        if (stepIndex <= 0) {\n            return null;\n        }\n        \n        if (stepIndex > ConstValue.STEP_CONFIG.length) {\n            stepIndex = ConstValue.STEP_CONFIG.length;\n        }\n        \n        return ConstValue.STEP_CONFIG[stepIndex - 1];\n    }\n\n    onDestroy(): void {\n        if (this.m_nodepoll) {\n            this.m_nodepoll.clear();\n        }\n    }\n}"]}