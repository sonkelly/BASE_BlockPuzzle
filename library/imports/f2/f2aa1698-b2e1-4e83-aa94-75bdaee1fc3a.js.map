{"version":3,"sources":["assets/Scripts/GetBoxGiftItem.ts"],"names":[],"mappings":"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","file":"","sourceRoot":"/","sourcesContent":["const { ccclass, property } = cc._decorator;\nimport EventListener from \"./event_listener\";\nimport { Property } from \"./Property\";\n@ccclass\nexport default class GetBoxGiftItem extends cc.Component {\n    @property(cc.Node)\n    m_n_freebtn: cc.Node = null;\n\n    @property(cc.Node)\n    m_n_sharebtn: cc.Node = null;\n\n    @property(cc.Node)\n    m_n_box: cc.Node = null;\n\n    private _onshowback: boolean = false;\n    private _callback: Function = null;\n\n    start() {\n        EventListener.instance.on(window.ON_SHOW_BACK, this.onshowback, this);\n    }\n\n    showView(callback: Function) {\n        this._callback = callback;\n        this.m_n_freebtn.active = !window.BOX_SHARE;\n        this.m_n_sharebtn.active = window.BOX_SHARE;\n        \n        this.m_n_box.runAction(cc.sequence(\n            cc.repeat(cc.sequence(\n                cc.rotateTo(.1, -10),\n                cc.rotateTo(.1, 10)\n            ), 3),\n            cc.rotateTo(.1, 0)\n        ));\n    }\n\n    onDestroy() {\n        EventListener.instance.off(window.ON_SHOW_BACK, this);\n    }\n\n    onshowback(time: number) {\n        if (this._onshowback) {\n            if (time >= window.SHARE_TIME) {\n                this.onFreeGet();\n            } else {\n                r.default.showShareFailTips();\n            }\n            this._onshowback = false;\n        }\n    }\n\n    onClose() {\n        if (this._callback) {\n            this._callback();\n            this._callback = null;\n        }\n        this.node.active = false;\n    }\n\n    onFreeGet() {\n        const self = this;\n        lplatform.showRanRewardedVideo(() => {\n            const items: number[] = [1, 20];\n            const index: number = a.random(0, 1500) > 750 ? 0 : 1;\n            \n            a.showGetItem(items[index], index, null, 0, 0);\n            \n            if (index === 0) {\n                window.INIT_GAME_SAVE_DATA.tool[0] += items[index];\n            } else {\n                window.INIT_GAME_SAVE_DATA.gold_num += items[index];\n            }\n            \n            if (Property.GAME_CONTROL) {\n                Property.GAME_CONTROL.BoxReward(index);\n            }\n            \n            self.onClose();\n        });\n    }\n\n    onShareGet() {\n        this._onshowback = true;\n        s.shareAppMessage({\n            title: \"我就看着你，直到你打开宝箱为止\",\n            imageUrl: window.tempFileURL[3]\n        });\n    }\n}"]}